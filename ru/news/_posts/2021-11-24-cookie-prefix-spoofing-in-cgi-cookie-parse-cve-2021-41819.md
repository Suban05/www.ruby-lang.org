---
layout: news_post
title: "CVE-2021-41819: Подделка префикса Cookie в CGI::Cookie.parse"
author: "mame"
translator: "suban05"
date: 2021-11-24 12:00:00 +0000
tags: security
lang: ru
---

Обнаружена уязвимость подделки префикса Cookie в CGI::Cookie.parse.
Этой уязвимости был присвоен идентификатор CVE [CVE-2021-41819](https://www.cve.org/CVERecord?id=CVE-2021-41819).
Мы настоятельно рекомендуем обновить Ruby.

## Подробности

В старых версиях `CGI::Cookie.parse` применялась декодировка URL к именам cookie.
Атакующий мог использовать эту уязвимость для подделки префиксов безопасности в именах cookie, что могло обмануть уязвимое приложение.

С этим исправлением `CGI::Cookie.parse` больше не декодирует имена cookie.
Обратите внимание, что это несовместимость, если имена cookie, которые вы используете, содержат символы, отличные от буквенно-цифровых, которые закодированы URL.

Эта проблема аналогична [CVE-2020-8184](https://www.cve.org/CVERecord?id=CVE-2020-8184).

Если вы используете Ruby 2.7 или 3.0:

* Пожалуйста, обновите гем cgi до версии 0.3.1, 0.2.1 и 0.1.1 или более поздней. Вы можете использовать `gem update cgi` для его обновления. Если вы используете bundler, добавьте `gem "cgi", ">= 0.3.1"` в ваш `Gemfile`.
* Или, пожалуйста, обновите Ruby до версии 2.7.5 или 3.0.3.

Если вы используете Ruby 2.6:

* Пожалуйста, обновите Ruby до версии 2.6.9. *Вы не можете использовать `gem update cgi` для Ruby 2.6 или более ранних версий.*

## Затронутые версии

* ruby 2.6.8 или более ранние (Вы не можете использовать `gem update cgi` для этой версии.)
* гем cgi 0.1.0 или ранее (которые поставляются с Ruby 2.7 серии до Ruby 2.7.5)
* гем cgi 0.2.0 или ранее (которые поставляются с Ruby 3.0 серии до Ruby 3.0.3)
* гем cgi 0.3.0 или ранее

## Благодарности

Спасибо [ooooooo_q](https://hackerone.com/ooooooo_q) за обнаружение этой проблемы.

## История

* Изначально опубликовано 2021-11-24 12:00:00 (UTC)
